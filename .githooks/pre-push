#!/bin/bash
# Pre-push hook: run tests before pushing.
# Install via: just setup-hooks

echo "Running tests before push..."

# Use nextest if available, otherwise cargo test
if command -v cargo-nextest &> /dev/null; then
    if ! cargo nextest run; then
        echo "❌ Tests failed. Fix failing tests before pushing."
        exit 1
    fi
else
    if ! cargo test; then
        echo "❌ Tests failed. Fix failing tests before pushing."
        exit 1
    fi
fi

echo "✓ All tests passed, pushing..."
